{% extends '../header.html' %}
{% load static %}
{% block content %}

{% include './auth_header.html' %}


        <center>
            
            <div uk-grid style="padding: 3%;">
                <div class="uk-width-1-4" style="text-align: left;">
                    <label style="font-size: 200%; font-weight: 600; color: rgb(0, 116, 161);">Agents Listing</label>
                    <br/><br/>
                    <button class="uk-button uk-button-secondary" type="button" uk-toggle="target: #vbs-travel-new-agent">Add New Agent</button>
                    <br/><br/>
                    <div class="uk-padding-small uk-tile-secondary" style="width: 100%; max-height: 500px; overflow-y: scroll; scroll-behavior: smooth; text-align: left;">
                        {% for i in agents_list %}

                        <div class="uk-tile uk-tile-primary" style="width: 100%; padding: 3%; margin-bottom: 2%;">
                            <label style="font-size: 130%; text-transform: capitalize">{{i.employee_auth_user_ref.first_name }}</label>
                            <label style="font-size: 130%; text-transform: capitalize">{{i.employee_auth_user_ref.last_name }}</label>
                            <br/>
                            <hr>
                            <button class="uk-button uk-button-default" onClick='clicked({{i.id}})'>View Details</button>
                        </div>

                        {% endfor %}

                        {% comment %} <div class="uk-tile uk-tile-primary" style="width: 100%; padding: 3%; margin-bottom: 2%;">
                            <label style="font-size: 130%;">Harish Ramjan</label>
                            <br/>
                            <hr>
                            <button class="uk-button uk-button-default">View Chart</button>
                        </div>
                        <div class="uk-tile uk-tile-primary" style="width: 100%; padding: 3%; margin-bottom: 2%;">
                            <label style="font-size: 130%;">Harish Ramjan</label>
                            <br/>
                            <hr>
                            <button class="uk-button uk-button-default">View Chart</button>
                        </div>
                        <div class="uk-tile uk-tile-primary" style="width: 100%; padding: 3%; margin-bottom: 2%;">
                            <label style="font-size: 130%;">Harish Ramjan</label>
                            <br/>
                            <hr>
                            <button class="uk-button uk-button-default">View Chart</button>
                        </div>
                        <div class="uk-tile uk-tile-primary" style="width: 100%; padding: 3%; margin-bottom: 2%;">
                            <label style="font-size: 130%;">Harish Ramjan</label>
                            <br/>
                            <hr>
                            <button class="uk-button uk-button-default">View Chart</button>
                        </div>
                        <div class="uk-tile uk-tile-primary" style="width: 100%; padding: 3%; margin-bottom: 2%;">
                            <label style="font-size: 130%;">Harish Ramjan</label>
                            <br/>
                            <hr>
                            <button class="uk-button uk-button-default">View Chart</button>
                        </div> {% endcomment %}
                        
                    </div>
                </div>
    {% include 'travel/admin/dialogs/agentacc__new_agent.html' %}

    <div class="uk-width-3-4" style="text-align: left;">
        <div class="uk-card uk-card-default uk-card-body" style="width: 100%; height: 100%;">
            <center>
                <div id="client-not-selected" style="font-size: 200%; margin-top: 5%; width: 50%;">
                    <i class="fa-regular fa-hand-pointer"></i><br/>
                    No agent selected. Please select the agent and view the records
                </div> 
                <div id="client_details"></div>

            </center>
        </div>
    </div>

        <center>
            <div style="text-align: left; padding-left: 3%;">
                <label style="font-size: 200%; font-weight: 600; color: rgb(0, 116, 161);">Agents having applications at Payments stage </label>
                <br/><br/>
                <div uk-slider style="padding-right: 3%;">
                    <ul class="uk-slider-items uk-child-width-1-3@s uk-child-width-1-4@ uk-grid" style="text-align: left;">
                        <li>
                            <div class="uk-tile uk-tile-secondary" style="padding: 7%; border-radius: 5px">
                                <div uk-grid class="uk-child-width-1-2">
                                    <div>
                                        <label style="font-size: 140%;">Mohsin</label>
                                        <br/>
                                        <label style="font-size: 180%;">120 pending</label>
                                    </div>
                                    <div style="vertical-align: middle;">
                                        <button class="uk-button uk-button-primary"><span uk-icon="mail"></span>&nbsp;&nbsp;&nbsp;&nbsp;Alert</button>
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="uk-tile uk-tile-secondary" style="padding: 7%; border-radius: 5px">
                                <div uk-grid class="uk-child-width-1-2">
                                    <div>
                                        <label style="font-size: 140%;">Mohsin</label>
                                        <br/>
                                        <label style="font-size: 180%;">120 pending</label>
                                    </div>
                                    <div style="vertical-align: middle;">
                                        <button class="uk-button uk-button-primary"><span uk-icon="mail"></span>&nbsp;&nbsp;&nbsp;&nbsp;Alert</button>
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="uk-tile uk-tile-secondary" style="padding: 7%; border-radius: 5px">
                                <div uk-grid class="uk-child-width-1-2">
                                    <div>
                                        <label style="font-size: 140%;">Mohsin</label>
                                        <br/>
                                        <label style="font-size: 180%;">120 pending</label>
                                    </div>
                                    <div style="vertical-align: middle;">
                                        <button class="uk-button uk-button-primary"><span uk-icon="mail"></span>&nbsp;&nbsp;&nbsp;&nbsp;Alert</button>
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="uk-tile uk-tile-secondary" style="padding: 7%; border-radius: 5px">
                                <div uk-grid class="uk-child-width-1-2">
                                    <div>
                                        <label style="font-size: 140%;">Mohsin</label>
                                        <br/>
                                        <label style="font-size: 180%;">120 pending</label>
                                    </div>
                                    <div style="vertical-align: middle;">
                                        <button class="uk-button uk-button-primary"><span uk-icon="mail"></span>&nbsp;&nbsp;&nbsp;&nbsp;Alert</button>
                                    </div>
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </center>
        
    </div>
    <script>
        const client_details = document.getElementById("client_details")
        const client_not_selected = document.getElementById("client-not-selected")

        function clicked(id) {
            if(id !== null){
                $.ajax({
                    url: `http://localhost:8000/travel/api/agent_details/${id}`,
                    type: 'GET',
                    success: function(data){
                        console.log('api run response', data)
                        client_not_selected.classList.add('not-visible')
                        client_details.innerHTML = `<div style="text-align: left;">
                        <div style="width: 100%; height: 100%;">
                                <label style="font-size: 160%">${data?.data[0][0]?.employee_auth_user_ref?.first_name + " " + data?.data[0][0]?.employee_auth_user_ref?.last_name}</label>
                            </div>
                                <br/><br/>
                                <div uk-grid class="uk-child-width-1-3">
                                    <div>
                                        <div class="uk-tile uk-tile-default" style="padding: 5%; border: 3px solid skyblue">
                                            Total VISAs: <br/>
                                            <label style="font-size: 250%">${data?.data[1].length}</label>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="uk-tile uk-tile-default" style="padding: 5%; border: 3px solid skyblue">
                                            Total Packages: <br/>
                                            <label style="font-size: 250%">${data?.data[2].length}</label>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="uk-tile uk-tile-default" style="padding: 5%; border: 3px solid skyblue">
                                            Total Tickets: <br/>
                                            <label style="font-size: 250%">${data?.data[3].length}</label>
                                        </div>
                                    </div>
                                </div>
        
                                <hr style="border-color: black;">
        
                                <label style="font-size: 110%; font-weight: 600; color: rgb(0, 116, 161);">All applications handled by ${data?.data[0][0]?.employee_auth_user_ref?.first_name + " " + data?.data[0][0]?.employee_auth_user_ref?.last_name}</label>
                                <br/><br/>
        
                                <div style="height: 300px; overflow-y: scroll; scroll-behavior: smooth; text-align: left;">
                                    <div class="uk-card uk-card-secondary" style="padding: 3%;">
                                        <div uk-grid class="uk-child-width-1-4" style="font-weight: 700;">
                                            <div>Client Name</div>
                                            <div>Category</div>
                                            <div>Stage</div>
                                            <div></div>
                                        </div>
                                    </div>
                                    ${data?.data[1].map(item => `<div class="uk-card uk-card-default" style="padding: 3%;">
                                        <div uk-grid class="uk-child-width-1-4">
                                            <div>${item?.travel_client_ref?.client_name}</div>
                                            <div><span class="uk-badge uk-padding-small">VISA</span></div>
                                            <div>${item?.stage}</div>
                                            <div><button class="uk-button uk-button-default">Explore</button></div>
                                        </div>
                                    </div>`)}
                                    ${data?.data[2].map(item => `<div class="uk-card uk-card-default" style="padding: 3%;">
                                        <div uk-grid class="uk-child-width-1-4">
                                            <div>${item?.travel_client_ref?.client_name}</div>
                                            <div><span class="uk-badge uk-padding-small">Packages</span></div>
                                            <div>${item?.stage}</div>
                                            <div><button class="uk-button uk-button-default">Explore</button></div>
                                        </div>
                                    </div>`)}
                                    ${data?.data[3].map(item => `<div class="uk-card uk-card-default" style="padding: 3%;">
                                        <div uk-grid class="uk-child-width-1-4">
                                            <div>${item?.travel_client_ref?.client_name}</div>
                                            <div><span class="uk-badge uk-padding-small">Tickets</span></div>
                                            <div>${item?.stage}</div>
                                            <div><button class="uk-button uk-button-default">Explore</button></div>
                                        </div>
                                    </div>`)}
                                    
                                </div>
                                
        
                            </div>
        
                </center>
        
                <hr style="border-color: black;">
        
                <center>
                    <div style="text-align: left; padding-left: 3%;">
                        <label style="font-size: 200%; font-weight: 600; color: rgb(0, 116, 161);">Agents with most pending application </label>
                        <br/><br/>
                        <div uk-slider style="padding-right: 3%;">
                            <ul class="uk-slider-items uk-child-width-1-3@s uk-child-width-1-4@ uk-grid" style="text-align: left;">
                                <li>
                                    <div class="uk-tile uk-tile-secondary" style="padding: 7%; border-radius: 5px">
                                        <div uk-grid class="uk-child-width-1-2">
                                            <div>
                                                <label style="font-size: 140%;">Mohsin</label>
                                                <br/>
                                                <label style="font-size: 180%;">120 pending</label>
                                            </div>
                                            <div style="vertical-align: middle;">
                                                <button class="uk-button uk-button-primary"><span uk-icon="mail"></span>&nbsp;&nbsp;&nbsp;&nbsp;Alert</button>
                                            </div>
                                        </div>
                                    </div>
                                </li>
                                <li>
                                    <div class="uk-tile uk-tile-secondary" style="padding: 7%; border-radius: 5px">
                                        <div uk-grid class="uk-child-width-1-2">
                                            <div>
                                                <label style="font-size: 140%;">Mohsin</label>
                                                <br/>
                                                <label style="font-size: 180%;">120 pending</label>
                                            </div>
                                            <div style="vertical-align: middle;">
                                                <button class="uk-button uk-button-primary"><span uk-icon="mail"></span>&nbsp;&nbsp;&nbsp;&nbsp;Alert</button>
                                            </div>
                                        </div>
                                    </div>
                                </li>
                                <li>
                                    <div class="uk-tile uk-tile-secondary" style="padding: 7%; border-radius: 5px">
                                        <div uk-grid class="uk-child-width-1-2">
                                            <div>
                                                <label style="font-size: 140%;">Mohsin</label>
                                                <br/>
                                                <label style="font-size: 180%;">120 pending</label>
                                            </div>
                                            <div style="vertical-align: middle;">
                                                <button class="uk-button uk-button-primary"><span uk-icon="mail"></span>&nbsp;&nbsp;&nbsp;&nbsp;Alert</button>
                                            </div>
                                        </div>
                                    </div>
                                </li>
                                <li>
                                    <div class="uk-tile uk-tile-secondary" style="padding: 7%; border-radius: 5px">
                                        <div uk-grid class="uk-child-width-1-2">
                                            <div>
                                                <label style="font-size: 140%;">Mohsin</label>
                                                <br/>
                                                <label style="font-size: 180%;">120 pending</label>
                                            </div>
                                            <div style="vertical-align: middle;">
                                                <button class="uk-button uk-button-primary"><span uk-icon="mail"></span>&nbsp;&nbsp;&nbsp;&nbsp;Alert</button>
                                            </div>
                                        </div>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>
                </center>
        
                <br/><hr style="border-color: black;"><br/>
            </div>`
                    },
                    error: function(jqXHR, exception){
                        console.log(jqXHR, ' | ', exception);
                        alertbox.innerHTML = "It seems server side erro has occured. Try again after some time. Still if problem persist, contact developer@vsbizz.com";
                    },        
                })
            } 
        }
    </script>
{% endblock content %}